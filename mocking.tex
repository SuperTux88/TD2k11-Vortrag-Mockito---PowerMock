\documentclass{beamer}

% uncomment to generate printer friendly scaled version
\usepackage{pgfpages}
\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}
\usepackage[T1]{fontenc}
\usepackage{graphicx}


\usepackage{listings} \lstset{numbers=left, numberstyle=\tiny, numbersep=5pt, showstringspaces=false, basicstyle=\scriptsize} \lstset{language=Java} 

\usetheme{Darmstadt}
% BUILD SCRIPT HOOKS - DO NOT REMOVE THIS COMMENTS %
%%%%%THEME_PLACEHOLDER_JENKINSBUILD%%%%%
%%%%%HANDOUT_PLACEHOLDER_JENKINSBUILD%%%%%
% END OF BUILD SCRIPT HOOKS %
%\pgfpagesuselayout{4 on 1}[a4paper,border shrink=5mm,landscape]

\setbeamercovered{transparent}
%\setbeamertemplate{footline}[frame number]

\title{Test driven development mit JUnit, Mockito und PowerMock}
\institute{Computerseminar Tondorf 2011}

\author[F. Becker, B. Neff]{
        Felix Becker \& 
	Benjamin Neff
}

\begin{document}
	\begin{frame}
		\titlepage
	\end{frame}

	\begin{frame}
		\frametitle{Agenda}
		\setcounter{tocdepth}{1}
		\tableofcontents
	\end{frame}
	
	%
	% Einfuehrung
	%

	\section{Einführung}
	
		\subsection{Einführung in test driven development}

			\begin{frame}
				\frametitle{Was ist Unit-Testing?}
				Unit-Testing ist toll!
			\end{frame}

			\begin{frame}
				\frametitle{Was ist Test driven development?}
				Test driven development ist toll!
			\end{frame}

	%
	% Tools und Frameworks
	%
	
	\section{Tools \& Frameworks}

		\subsection{Was gibt es für Tools und Frameworks?}

			\begin{frame}
				\frametitle{Frameworks}
				\begin{itemize}
					\item{JUnit}
					\item{Mockito}
					\item{PowerMock}
					\item{(TestNG)}
				\end{itemize}
			\end{frame}

			\begin{frame}
				\frametitle{Continuous Integration}
				Continuous Integration ist toll!
			\end{frame}

			\begin{frame}
				\frametitle{EMMA}
				EMMA ist ne Geile!
			\end{frame}

	%
	% Probleme 
	%
	
	\section{Probleme}

		\subsection{Welche Probleme können beim Unit-testen auftauchen?}
		
			\begin{frame}
				\frametitle{Refactoring}
				Refactoring ist toll!
			\end{frame}

			\begin{frame}
				\frametitle{Nicht testbares Verhalten}
				Nicht testbares Verhalten ist nicht toll!
			\end{frame}

			\begin{frame}
				\frametitle{Beispiele}
				Beispiele wären geil!
			\end{frame}

	%
	% Mockito und PowerMock
	%
	
	\section{Mockito \& PowerMock}
		\subsection{Einleitung}
			\begin{frame}
				\frametitle{Was ist ein Mock?}
				\begin{itemize}
					\item{engl. Mock-up (Attrappe / Simulation)}
					\item{Attrappe eines Objekts}
					\item{Selbe Schnittstelle wie das Original-Objekt}
					\item{Ersatz für Komponenten, die die zu testende Komponente benötigt}
					\item{Garantiert definiertes Verhalten während des Tests}
				\end{itemize}

			\end{frame}

			\begin{frame}
				\frametitle{Mockito- und Power-Mocks}
				Mockito
				\begin{itemize}
					\item{Einfache Erstellung}
					\item{Leicht konfigurierbares Verhalten}
					\item{Aufzeichnung aller Calls}
				\end{itemize}
				\pause
				PowerMock
				\begin{itemize}
					\item{Mit Java-Bordmitteln normalerweise nicht mockbare Komponenten mocken}
					\item{Deep and dark magic}
						\begin{itemize}
							\item{Byte code Manipulation (javaassist)}
							\item{Classloader-Manipulation}
						\end{itemize}
				\end{itemize}
			\end{frame}

		\subsection{Mocking}
		\subsection{Partial Mocking}
		\subsection{Constructor call prevention}
			\begin{frame}[fragile]
				\frametitle{A constructor nightmare}

				\begin{lstlisting}
					public class Foo {
					  public Foo(){
					    if(!MyFrameworkMegaUtil.isFrameworkProperlyInitialized()){
					      MyFrameworkMegaUtil.initializeFramework();	
					    }
					  }

					  public int sum(int x, int y){
					    return x+y;
					  }
					}
				\end{lstlisting}

			\end{frame}

			\begin{frame}[fragile]
				\frametitle{Solution!}

				\begin{lstlisting}
					public class FooTest {
					  @Test
					  public void testSum(){
					    Foo comp = WhiteBox.newInstance(Foo.class);
					    assertEquals(5, comp.sum(2, 3));
					  }
					}
				\end{lstlisting}

			\end{frame}
		\subsection{Static / Final Mocks}

		\subsection{Problem 1}

			\begin{frame}
				\frametitle{Problem}
				\lstinline|System.out.println("hello world");|
			\end{frame}

			\begin{frame}
				\frametitle{Lösung}
				Lösung!
			\end{frame}


		\subsection{Problem 2}

			\begin{frame}[fragile]
				\frametitle{Problem}

				\begin{lstlisting}
					@BadStyle
					public class Foo {
					  private Bar bar = Bar.getInstance();

					  public void callBar(){
					    bar.call("oh, hi!");
					  }
					}
				\end{lstlisting}

			\end{frame}

			\begin{frame}
				\frametitle{Lösung}
				Lösung!!!!
			\end{frame}

		\subsection{Common Pitfalls}

			\begin{frame}
				\frametitle{Falsches Benutzen}
				Wenn man es falsch macht geht es nicht mehr.
				%.whenNew(Socket.class).with...
			\end{frame}

\end{document}
